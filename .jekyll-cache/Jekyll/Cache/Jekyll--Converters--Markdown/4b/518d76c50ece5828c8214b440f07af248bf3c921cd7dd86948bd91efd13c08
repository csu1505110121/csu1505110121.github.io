I"¶ <!--
 >Theory and Computational Biology: From Molecular to System
-->
<!-- > å½“ä½ æ‰“å¼€æˆ‘è¿™ä¸ªç½‘é¡µæ—¶ï¼Œæ­å–œä½ ï¼Œä½ ç¦»æ¯•ä¸šä¸è¿œäº†ï¼Œæ’¸èµ·è¢–å­åŠ æ²¹å¹²å•Šï¼Œå¥¥åˆ©ç»™ï¼  
> <p align="right">-- Forty Braver </p>
-->

<h1 id="1-introduction">1. Introduction</h1>

<p>Accurate description of the electrostatic interactions plays significant role in the molecular simulations. For well characterizing the electrostatic interactions, various polarizable methods have been proposed,<a href="#refer-anchor-1"><sup>1</sup></a> such as fluctuating charge (FQ), inducible dipole (ID), and Drude oscillator and so on. Among these methods, polarization catastrophe was observed. An alternative was polarizable Gaussian Multipole (pGM) Model which utilizing the Gaussian functions with the point charges and dipoles replaced by s-orbital  functions and p-orbital functions. This method could bypass the catastrophe automatically given the Gaussian functions are sufficiently diffuse. Recently, the robustness of pGM model has been validated on the interaction energies,<a href="#refer-anchor-2"><sup>2</sup></a> many-body interaction energies together with the non-additive and additive contribution,<a href="#refer-anchor-2"><sup>2</sup></a> and polarizability anisotropy.<a href="#refer-anchor-3"><sup>3</sup></a> However, the input file preparation for the pGM model parameter determination is error-prone and laborious. As a consequence, we developed a program, PyRESP_GEN , which is easy-to-use and flexible.<a href="#refer-anchor-4"><sup>4</sup></a> This program only requires ESP data file generated by espgen and could dumps 1st stage and 2nd stage file for pGM model parameterization, automatically.</p>

<p>In this tutorial, we will give a detailed instruction on how to make use of PyRESP_GEN<a href="#refer-anchor-4"><sup>4</sup></a> for the input generation of PyRESP<a href="#refer-anchor-2"><sup>2</sup></a>.</p>

<hr />

<p>This tutorial is organized in the following order:</p>
<ul>
  <li>Program Installation
    <ul>
      <li>PyRESP_GEN</li>
      <li>PyRESP</li>
    </ul>
  </li>
  <li>Arguments explanation of PyRESP_GEN</li>
  <li>Examples
    <ul>
      <li>CH3SCH3</li>
      <li>NH4+ (charged molecule)</li>
      <li>CH3NH2</li>
    </ul>
  </li>
  <li>References</li>
</ul>

<hr />

<h1 id="2-installation">2. Installation</h1>

<h4 id="21-installation-of-pyresp_gen">2.1 Installation of PyRESP_GEN</h4>

<ul>
  <li>From source</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ git clone git@github.com:csu1505110121/pyresp_gen.git
$ cd pyresp_gen
$ conda env create -n ENV_NAME -f pyresp_gen_env.yml
$ conda activate ENV_NAME
$ export PATH=/path/to/pyresp_gen:$PATH
    Setting the environment path:
      - For `Zsh` Shell: Editing the ~/.zshrc and adding the following line:
         export PATH=/your/path/to/pyresp_gen:$PATH
      - For `Bash` User: Editing the ~/.bashrc file and adding the same line:
         export PATH=/your/path/to/pyresp_gen:$PATH
$ source ~/.zshrc or source ~/.bashrc (effective immediately)
</code></pre></div></div>

<p>The whole package contains the following files and arranged in such hierarchical structure</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ tree
.
â”œâ”€â”€ README.md
â”œâ”€â”€ __init__.py
â”œâ”€â”€ __pycache__
â”‚   â”œâ”€â”€ constant.cpython-38.pyc
â”‚   â”œâ”€â”€ constant_radii.cpython-38.pyc
â”‚   â”œâ”€â”€ prepin.cpython-38.pyc
â”‚   â””â”€â”€ zmatrix.cpython-38.pyc
â”œâ”€â”€ constant.py
â”œâ”€â”€ constant_radii.py
â”œâ”€â”€ example
â”‚   â”œâ”€â”€ C2H6_b3lyp_321g_esp.dat
â”‚   â”œâ”€â”€ C3H8_mp2_a4z_esp.dat
â”‚   â”œâ”€â”€ C6H6_b3lyp_321g_esp.dat
â”‚   â”œâ”€â”€ CH3F_ccsd_a4z_esp.dat
â”‚   â”œâ”€â”€ CH3NH2_mp2_a4z_esp.dat
â”‚   â”œâ”€â”€ CH3S2CH3_b3lyp_321g_esp.dat
â”‚   â”œâ”€â”€ CH3SO2CH3_mp2_a4z_esp.dat
â”‚   â”œâ”€â”€ CHNHOH_mp2_a4z_esp.dat
â”‚   â”œâ”€â”€ H2_ccsd_a5z_esp.dat
â”‚   â”œâ”€â”€ esp.dat
â”‚   â””â”€â”€ qiang_test_case_esp_b321.dat
â”œâ”€â”€ prepin.py
â”œâ”€â”€ pyresp_gen.py
â”œâ”€â”€ pyresp_gen_env.yml
â””â”€â”€ zmatrix.py
</code></pre></div></div>
<p>The necessary files are <code class="language-plaintext highlighter-rouge">constant.py</code>,<code class="language-plaintext highlighter-rouge">constant_radii.py</code>,<code class="language-plaintext highlighter-rouge">prepin.py</code>,<code class="language-plaintext highlighter-rouge">pyresp_gen.py</code>,and <code class="language-plaintext highlighter-rouge">zmatrix.py</code>.</p>

<p>Core functions are all stored in the file <code class="language-plaintext highlighter-rouge">zmatrix.py</code>. Some test examples could be found in directory <code class="language-plaintext highlighter-rouge">example</code>.</p>

<h4 id="22-installation-of-pyresp">2.2 Installation of PyRESP</h4>

<ul>
  <li>From source
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ git clone git@github.com:ShijiZ/PyRESP.git
$ export PATH=/path/to/PyRESP:$PATH
  Setting the environment path:
    - For `Zsh` User: Editing the ~/.zshrc and adding the following line:
       export PATH=/your/path/to/PyRESP:$PATH
    - For `Bash` User: Editing the ~/.bashrc file and adding the same line:
       export PATH=/your/path/to/PyRESP:$PATH
$ export HOME_PYRESP=/your/path/to/PyRESP/polarizability
$ source ~/.zshrc or source ~/.bashrc (effective immediately)
</code></pre></div>    </div>
  </li>
</ul>

<p>The whole package contains the following files</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ tree
.
â”œâ”€â”€ polarizability
â”‚   â””â”€â”€ pGM-pol-2016-09-01
â”œâ”€â”€ py_resp.py
</code></pre></div></div>
<p><code class="language-plaintext highlighter-rouge">py_resp.py</code> is the main script, and <code class="language-plaintext highlighter-rouge">pGM-pol-2016-09-01</code> stores the polarizability parameters derived by Wang et al.<a href="#refer-anchor-3"><sup>3</sup></a></p>

<h1 id="3-arguments-explanation">3. Arguments explanation</h1>

<h4 id="31-pyresp_gen">3.1 PyRESP_GEN</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  Usage: pyresp_gen.py [-h] --espdat ESPDAT [--Istage ISTAGE] [--IIstage IISTAGE] [--ptype PTYPE] [--dtype DTYPE] [--nmol NMOL]
                     [--charge CHARGE] [--QWTw QWTW] [--QWTs QWTS] [--PWTw PWTW] [--PWTs PWTS] [--EXC12 EXC12] [--EXC13 EXC13]
                     [--DEPTH DEPTH] [--verbose VERBOSE] [--strategy STRATEGY]
</code></pre></div></div>

<h1 id="references">References</h1>

<div id="refer-anchor-1"></div>
<p>[1] Qiang Zhu, Yang Ge, Wei Li,* and Jing Ma*. <a href="https://pubs.acs.org/doi/abs/10.1021/acs.jctc.2c01130?casa_token=eu4gzasL3FgAAAAA:9WLmHUtsPjEvRSd4qAFw76UMxVgQdXr2MDYXNv0nnQsa929qSeTpTXxNlTssMeDPgFbtCvYrKbhtLnr1">Treating Polarization Effects in Charged and Polar Bio-Molecules Through Variable Electrostatic Parameters.</a> <em>J. Chem. Theory Comput.</em> <strong>2023</strong>, 19, 2, 396â€“411;</p>

<div id="refer-anchor-2"></div>
<p>[2] Shiji Zhao, Haixin Wei, Piotr Cieplak, Yong Duan,* and Ray Luo.* <a href="https://pubs.acs.org/doi/abs/10.1021/acs.jctc.2c00230?casa_token=ztCXn3gxZjgAAAAA:OXdVwLy-DwjKzCY2-62X302bHkTPHO5LqnZnSZfjSY5k2X_aCJScTlgynnnfSYbf-_ynAK9rHud0aFXj">PyRESP: A Program for Electrostatic Parameterizations of Additive and Induced Dipole Polarizable Force Fields.</a> <em>J. Chem. Theory Comput.</em> <strong>2022</strong>, 18, 6, 3654â€“3670</p>

<div id="refer-anchor-3"></div>
<p>[3] Junmei Wang*, Piotr Cieplak, Ray Luo, and Yong Duan*. <a href="https://pubs.acs.org/doi/abs/10.1021/acs.jctc.8b00603?casa_token=hzcpqUV1swgAAAAA:q_uwP4QZEup2RsmEgMMhHdRf0igZ8bSEm7-mcfaEAWlLjKDyIZ8UM0jZDpKoNXahsN0iklXs5OCt_aAS">Development of Polarizable Gaussian Model for Molecular Mechanical Calculations I: Atomic Polarizability Parameterization To Reproduce ab Initio Anisotropy.</a> <em>J. Chem. Theory Comput.</em> <strong>2019</strong>, 15, 2, 1146â€“1158</p>

<div id="refer-anchor-4"></div>
<p>[4] Qiang Zhu, Yong Duan,* Ray Luo.* <strong>2023</strong> (To be submitted)</p>

<div align="center">
<img src="/assets/2022_python_plot/RMSD_rot_bonds_distribution.png" width="1000" height="" alt="rmsd" />
 </div>
:ET
I"L <!--
 >Theory and Computational Biology: From Molecular to System
-->
<!-- > 当你打开我这个网页时，恭喜你，你离毕业不远了，撸起袖子加油干啊，奥利给！  
> <p align="right">-- Forty Braver </p>
-->

<blockquote>
  <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>风物长宜放眼量，小不忍则乱大谋。（与君共勉）
</code></pre></div>  </div>
</blockquote>

<p>终于将预测脂水分配系数的工具投出去了，腾出部分时间来进行相关的总结了。（我把<a href="/assets/2022_python_plot/MS.pdf">Manuscript</a>和<a href="/assets/2022_python_plot/SI.pdf">Supprotin information</a>也一起放在这篇博客的后面，感兴趣的朋友可以取用，如果能引用就更加欢迎了！）</p>

<p>上次做完组会报告，隔壁实验室的师弟问我要了ppt说是想学习下我的作图，心中暗想自己的作图居然能得到部分认可，本着授之以鱼，不如授之以渔的观念，我干脆把我作图用到的脚本也全都online吧，一来可以做个科研记录，二来如果对志同道合的朋友有所帮助岂不美哉！</p>

<p>因为这篇工作99%的工作都是在python的框架下完成的，利用<code class="language-plaintext highlighter-rouge">matplotlib</code>工具包绘制图片远比利用<code class="language-plaintext highlighter-rouge">gnuplot</code>要方便地多，所以后续呈现的图也绝大多数都是利用python实现的。</p>

<p>本教程中用到的相关库的版本如下，大家也可以不必局限于这个版本，本教程中的图都是正文和SI中出现的子图，整个图片的整合可以利用各自喜欢的软件来进行，我比较倾向于利用<code class="language-plaintext highlighter-rouge">power point</code>来进行组合，大家可以用<code class="language-plaintext highlighter-rouge">Photoshop</code>等工具来进行。</p>

<h2 id="requirement">Requirement</h2>
<ul>
  <li>Python <code class="language-plaintext highlighter-rouge">3.8</code></li>
  <li>numpy <code class="language-plaintext highlighter-rouge">1.21.1</code></li>
  <li>pandas <code class="language-plaintext highlighter-rouge">1.3.1</code></li>
  <li>matplotlib <code class="language-plaintext highlighter-rouge">3.4.2</code></li>
</ul>

<h2 id="figures">Figures</h2>

<h1 id="红外光谱图绘制">红外光谱图绘制</h1>
<p>highlighted points:</p>
<ul>
  <li>绘制双Y轴并对两个轴着不同的颜色；</li>
  <li>绘制离散的竖线，利用<code class="language-plaintext highlighter-rouge">vline</code>来进行绘制</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> #!/bin/python
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt

# gaussian文件保存的红外光谱数据
filename = 'example_ir.txt'

# 读取文件中对应的数据
# 孤立的峰值数据
peak = []
# 通过展宽得到的连续的数据
broad = []

with open(filename,'r') as f:
  while True:
    line = f.readline()
    if not line:
      break
    else:
      if '# Peak information' in line:
        line = f.readline()
        for x in range(100000):
          line = f.readline()
          if '#' not in line:
            break
          else:
            peak.append([float(line.split()[1]),float(line.split()[2])])

with open(filename,'r') as f:
  while True:
    line = f.readline()
    if not line:
      break
    else:   
      if '# Spectra' in line:
        line = f.readline()
        for x in range(1000000):
          line = f.readline()
          if len(line.strip()) == 0:
            break
          else:
            broad.append([float(line.split()[0]),float(line.split()[1]),float(line.split()[2])])

#print(np.array(peak))
#print(np.array(broad))

# 初始化画布
fig, ax = plt.subplots(figsize=(12,8))

peak = np.array(peak)
broad = np.array(broad)

#print(peak.shape[0])

ax.plot(broad[:,0],broad[:,1],color='black',linestyle='-')

ax2 = ax.twinx()
for x in np.arange(peak.shape[0]):
  ax2.vlines(peak[x][0],0,peak[x][1],color='blue',linestyle='-')

ax2.set_ylim(-30,1600)
ax2.yaxis.set_ticks(np.arange(0,1500.1,500))
ax2.yaxis.set_tick_params(labelsize=14, color='blue')
ax2.spines['right'].set_color('blue')
ax2.xaxis.label.set_color('blue')
ax2.tick_params(axis='y',colors='blue')
ax2.set_ylabel(r'$Intensity~(10^{-40} esu^2 cm^2)$',fontsize=18,fontfamily='sans-serif',fontstyle='italic',color='blue',rotation=-90,labelpad=20)

ax.set_xlabel(r'Frequency $(cm^{-1})$',fontsize=18,fontfamily='sans-serif',fontstyle='italic')
ax.set_ylabel(r'$\epsilon~(M^{-1}cm^{-1})$',fontsize=18,fontfamily='sans-serif',fontstyle='italic')

ax.set_xlim(0,1800)
ax.set_ylim(-30,1600)

ax.xaxis.set_tick_params(labelsize=14)
ax.yaxis.set_tick_params(labelsize=14)

ax.xaxis.set_ticks(np.arange(0,1800.1,300))
ax.yaxis.set_ticks(np.arange(0,1500.1,500))

plt.tight_layout()

plt.savefig('examplt_ir_broaden.png',dpi=1000,bbox_inches='tight')

plt.show()
</code></pre></div></div>

<div align="center">
<img src="/assets/2022_python_plot/examplt_ir_broaden.png" width="800" height="" alt="output" />
 </div>

<p><a href="/assets/2022_python_plot/plot_ir.py">script</a>, <a href="/assets/2022_python_plot/example_ir.txt">ir_data</a></p>

<h1 id="静电势的绘制非python绘图">静电势的绘制（非python绘图）</h1>

<ol>
  <li>首先利用<code class="language-plaintext highlighter-rouge">gaussian</code>产生对应的<code class="language-plaintext highlighter-rouge">density.cube</code>和<code class="language-plaintext highlighter-rouge">potential.cube</code>文件，具体命令如下:
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>formchk *.chk *.fchk
cubegen 0 density *.fchk density.cube 0 h &amp;
cubegeb 0 potential *.fchk potential.cube 0 h &amp;
# 相关的命令解释我就不做介绍了，大家有兴趣的可以去gaussian官网上查询！
</code></pre></div>    </div>
  </li>
  <li>利用sob老师给出的<code class="language-plaintext highlighter-rouge">ESPiso.vmd</code>脚本产生对应的静电势图 (致谢师妹付路路！)
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#This script is used to draw ESP colored molecular vdW surface (rho=0.001) 
#density1.cub, ESP1.cub, density2.cub, ESP2.cub ... should be presented in current folder 
color scale method BWR 
color Display Background white 
axes location Off 
display depthcue off 
display rendermode GLSL 
light 2 on 
light 3 on 
material change transmode EdgyGlass 1.000000 
#The maximum number of systems to be loaded 
set nsystem 1 
#Lower and upper limit of color scale of ESP (a.u.) 
set colorlow -0.03 
set colorhigh 0.03 
for {set i 1} {$i&lt;=$nsystem} {incr i} { 
set id [expr $i-1] 
mol new density.cube 
mol addfile potential$i.cube               # this should be replaced with your defined filename 
mol modstyle 0 $id CPK 1.000000 0.300000 22.000000 22.000000 
mol addrep $id 
mol modstyle 1 $id Isosurface 0.001000 0 0 0 1 1 
mol modmaterial 1 $id EdgyGlass 
mol modcolor 1 $id Volume 1 
mol scaleminmax $id 1 $colorlow $colorhigh 
}
</code></pre></div>    </div>
  </li>
</ol>

<div align="center">
<img src="/assets/2022_python_plot/examplt_esp.png" width="500" height="" alt="esp" />
 </div>

<p>script:<a href="/assets/2022_python_plot/ESPiso.vmd">ESPiso.vmd</a></p>

<h1 id="绘制gaussian计算得到的振动模式-非python绘图">绘制gaussian计算得到的振动模式 (非python绘图)</h1>
<p>同样是结合<code class="language-plaintext highlighter-rouge">VMD</code>食用，致谢付路路师妹！</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>if you have any questions, please ref http://sobereva.com/567
Usage:
source GauNorm.tcl
norm $imode $scalfac $rad $color

- imode: the index of the mode
- sclfac: length of the vector
- rad: radius of the arrow
- colors: default set to be yellow
</code></pre></div></div>

<p>scripts:<a href="/assets/2022_python_plot/GauNorm.tcl">GauNorm.tcl</a>, <a href="/assets/2022_python_plot/drawarrow.tcl">drawarrow.tcl</a></p>

:ET
I"5><!--
 >Theory and Computational Biology: From Molecular to System
-->
<!-- > 当你打开我这个网页时，恭喜你，你离毕业不远了，撸起袖子加油干啊，奥利给！  
> <p align="right">-- Forty Braver </p>
-->

<h1 id="1-introduction">1. Introduction</h1>

<p>Accurate description of the electrostatic interactions plays significant role in the molecular simulations. For well characterizing the electrostatic interactions, various polarizable methods have been proposed,<a href="#refer-anchor-1"><sup>1</sup></a> such as fluctuating charge (FQ), inducible dipole (ID), and Drude oscillator and so on. Among these methods, polarization catastrophe was observed. An alternative was polarizable Gaussian Multipole (pGM) Model which utilizing the Gaussian functions with the point charges and dipoles replaced by s-orbital  functions and p-orbital functions. This method could bypass the catastrophe automatically given the Gaussian functions are sufficiently diffuse. Recently, the robustness of pGM model has been validated on the interaction energies,<a href="#refer-anchor-2"><sup>2</sup></a> many-body interaction energies together with the non-additive and additive contribution,<a href="#refer-anchor-2"><sup>2</sup></a> and polarizability anisotropy.<a href="#refer-anchor-3"><sup>3</sup></a> However, the input file preparation for the pGM model parameter determination is error-prone and laborious. As a consequence, we developed a program, PyRESP_GEN , which is easy-to-use and flexible.<a href="#refer-anchor-4"><sup>4</sup></a> This program only requires ESP data file generated by espgen and could dumps 1st stage and 2nd stage file for pGM model parameterization, automatically.</p>

<p>In this tutorial, we will give a detailed instruction on how to make use of PyRESP_GEN<a href="#refer-anchor-4"><sup>4</sup></a> for the input generation of PyRESP<a href="#refer-anchor-2"><sup>2</sup></a>.</p>

<hr />

<p>This tutorial is organized in the following order:</p>
<ul>
  <li>Program Installation
    <ul>
      <li>PyRESP_GEN</li>
      <li>PyRESP</li>
    </ul>
  </li>
  <li>Arguments explanation of PyRESP_GEN</li>
  <li>Examples
    <ul>
      <li>CH3SCH3</li>
      <li>NH4+ (charged molecule)</li>
      <li>CH3NH2</li>
    </ul>
  </li>
  <li>References</li>
</ul>

<hr />

<h1 id="2-installation">2. Installation</h1>

<h4 id="21-installation-of-pyresp_gen">2.1 Installation of PyRESP_GEN</h4>

<ul>
  <li>From source</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ git clone git@github.com:csu1505110121/pyresp_gen.git
$ cd pyresp_gen
$ conda env create -n ENV_NAME -f pyresp_gen_env.yml
$ conda activate ENV_NAME
$ export PATH=/path/to/pyresp_gen:$PATH
    Setting the environment path:
      - For `Zsh` Shell: Editing the ~/.zshrc and adding the following line:
         export PATH=/your/path/to/pyresp_gen:$PATH
      - For `Bash` User: Editing the ~/.bashrc file and adding the same line:
         export PATH=/your/path/to/pyresp_gen:$PATH
$ source ~/.zshrc or source ~/.bashrc (effective immediately)
</code></pre></div></div>

<p>The whole package contains the following files and arranged in such hierarchical structure</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ tree
.
├── README.md
├── __init__.py
├── __pycache__
│   ├── constant.cpython-38.pyc
│   ├── constant_radii.cpython-38.pyc
│   ├── prepin.cpython-38.pyc
│   └── zmatrix.cpython-38.pyc
├── constant.py
├── constant_radii.py
├── example
│   ├── C2H6_b3lyp_321g_esp.dat
│   ├── C3H8_mp2_a4z_esp.dat
│   ├── C6H6_b3lyp_321g_esp.dat
│   ├── CH3F_ccsd_a4z_esp.dat
│   ├── CH3NH2_mp2_a4z_esp.dat
│   ├── CH3S2CH3_b3lyp_321g_esp.dat
│   ├── CH3SO2CH3_mp2_a4z_esp.dat
│   ├── CHNHOH_mp2_a4z_esp.dat
│   ├── H2_ccsd_a5z_esp.dat
│   ├── esp.dat
│   └── qiang_test_case_esp_b321.dat
├── prepin.py
├── pyresp_gen.py
├── pyresp_gen_env.yml
└── zmatrix.py
</code></pre></div></div>
<p>The necessary files are <code class="language-plaintext highlighter-rouge">constant.py</code>,<code class="language-plaintext highlighter-rouge">constant_radii.py</code>,<code class="language-plaintext highlighter-rouge">prepin.py</code>,<code class="language-plaintext highlighter-rouge">pyresp_gen.py</code>,and <code class="language-plaintext highlighter-rouge">zmatrix.py</code>.</p>

<p>Core functions are all stored in the file <code class="language-plaintext highlighter-rouge">zmatrix.py</code>. Some test examples could be found in directory <code class="language-plaintext highlighter-rouge">example</code>.</p>

<h4 id="22-installation-of-pyresp">2.2 Installation of PyRESP</h4>

<ul>
  <li>From source
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ git clone git@github.com:ShijiZ/PyRESP.git
$ export PATH=/path/to/PyRESP:$PATH
  Setting the environment path:
    - For `Zsh` User: Editing the ~/.zshrc and adding the following line:
       export PATH=/your/path/to/PyRESP:$PATH
    - For `Bash` User: Editing the ~/.bashrc file and adding the same line:
       export PATH=/your/path/to/PyRESP:$PATH
$ export HOME_PYRESP=/your/path/to/PyRESP/polarizability
$ source ~/.zshrc or source ~/.bashrc (effective immediately)
</code></pre></div>    </div>
  </li>
</ul>

<p>The whole package contains the following files</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ tree
.
├── polarizability
│   └── pGM-pol-2016-09-01
├── py_resp.py
</code></pre></div></div>
<p><code class="language-plaintext highlighter-rouge">py_resp.py</code> is the main script, and <code class="language-plaintext highlighter-rouge">pGM-pol-2016-09-01</code> stores the polarizability parameters derived by Wang et al.<a href="#refer-anchor-3"><sup>3</sup></a></p>

<hr />

<h1 id="3-arguments-explanation">3. Arguments explanation</h1>

<h4 id="31-pyresp_gen">3.1 PyRESP_GEN</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  Usage: pyresp_gen.py [-h] --espdat ESPDAT [--Istage ISTAGE] [--IIstage IISTAGE] [--ptype PTYPE] [--dtype DTYPE] [--nmol NMOL]
                     [--charge CHARGE] [--QWTw QWTW] [--QWTs QWTS] [--PWTw PWTW] [--PWTs PWTS] [--EXC12 EXC12] [--EXC13 EXC13]
                     [--DEPTH DEPTH] [--verbose VERBOSE] [--strategy STRATEGY]
</code></pre></div></div>

<p><strong>Necessary arguments</strong>:</p>

<p><code class="language-plaintext highlighter-rouge">--espdat</code> or <code class="language-plaintext highlighter-rouge">-i</code> ESPDAT: Input file of esp data</p>

<p><strong>Optional arguments</strong>:</p>

<ol>
  <li>
    <p><code class="language-plaintext highlighter-rouge">-h</code> or <code class="language-plaintext highlighter-rouge">--help</code>: Show help message and exit</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">--Istage</code> or <code class="language-plaintext highlighter-rouge">-f1</code> ISTAGE: Output filename of 1st stage (default: <code class="language-plaintext highlighter-rouge">pyrespgen.1st</code>)</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">--IIstage</code> or <code class="language-plaintext highlighter-rouge">-f2</code> IISTAGE: Output filename of 2nd stage (default: <code class="language-plaintext highlighter-rouge">pyrespgen.2nd</code>)</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">--ptype</code> or <code class="language-plaintext highlighter-rouge">-p</code> PTYPE: Polarization type: 
 x <code class="language-plaintext highlighter-rouge">chg</code> | x <code class="language-plaintext highlighter-rouge">ind</code> |x <code class="language-plaintext highlighter-rouge">perm</code> | x <code class="language-plaintext highlighter-rouge">perm-v</code> (default: <code class="language-plaintext highlighter-rouge">chg</code>)</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">--dtype</code> or <code class="language-plaintext highlighter-rouge">-d</code> DTYPE: Damping function type: 
 x <code class="language-plaintext highlighter-rouge">additive</code> | x <code class="language-plaintext highlighter-rouge">applequist</code> | x <code class="language-plaintext highlighter-rouge">tinker</code> | x <code class="language-plaintext highlighter-rouge">exp</code> | x <code class="language-plaintext highlighter-rouge">linear</code> (default: <code class="language-plaintext highlighter-rouge">additive</code>)</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">--nmol</code> or <code class="language-plaintext highlighter-rouge">-n</code> NMOL: Number of conformations (default: <code class="language-plaintext highlighter-rouge">1</code>)</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">--charge</code> or <code class="language-plaintext highlighter-rouge">-q</code> CHARGE: Total charge for this structure or conformer (default: <code class="language-plaintext highlighter-rouge">0</code>)</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">--QWTw</code> or <code class="language-plaintext highlighter-rouge">-qwtw</code> QWTW: charge constraint ($a_q$) for 1st stage; (default: <code class="language-plaintext highlighter-rouge">0.0005</code>)</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">--QWTs</code> or <code class="language-plaintext highlighter-rouge">-qwts</code> QWTS: charge constraint ($a_q$) for 2nd stage; (default: <code class="language-plaintext highlighter-rouge">0.001</code>)</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">--PWTw</code> or <code class="language-plaintext highlighter-rouge">-pwtw</code> PWTW: permanent dipoles ($a_p$) for 1st stage; (default: <code class="language-plaintext highlighter-rouge">0.0005</code>)</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">--PWTs</code> or <code class="language-plaintext highlighter-rouge">-pwts</code> PWTS: permanent dipoles ($a_p$) for 2nd stage; (default: <code class="language-plaintext highlighter-rouge">0.001</code>)</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">--EXC12</code> or <code class="language-plaintext highlighter-rouge">-exc12</code> EXC12: include (0) or exclude (1) 1-2 interaction (default: <code class="language-plaintext highlighter-rouge">0</code>)</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">--EXC13</code> or <code class="language-plaintext highlighter-rouge">-exc13</code> EXC13: include (0) or exclude (1) 1-3 interaction (default: <code class="language-plaintext highlighter-rouge">0</code>)</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">--DEPTH</code> or <code class="language-plaintext highlighter-rouge">-depth</code> DEPTH: Maximum depth for searching equivalent atoms (default: <code class="language-plaintext highlighter-rouge">3</code>)</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">--verbose</code> or <code class="language-plaintext highlighter-rouge">-v</code> VERBOSE: Print verbose information (default: <code class="language-plaintext highlighter-rouge">0</code>)</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">--strategy</code> or <code class="language-plaintext highlighter-rouge">-strategy</code> STRATEGY: Strategy for pGM-perm, only for debugging (default: <code class="language-plaintext highlighter-rouge">2</code>)</p>
  </li>
</ol>

<h4 id="32-pyresp">3.2 PyRESP</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Usage: py_resp.py [-O] -i input -o output [-q qin] [-ip polariz] -t qout -e espot -s esout
</code></pre></div></div>

<p><strong>Optional arguments</strong>:</p>

<ol>
  <li>
    <p><code class="language-plaintext highlighter-rouge">-h</code>, <code class="language-plaintext highlighter-rouge">--help</code>:            Show this help message and exit</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">-O</code>          :            Overwrite output files if they exist</p>
  </li>
  <li><code class="language-plaintext highlighter-rouge">-i</code>, <code class="language-plaintext highlighter-rouge">--input</code> INPUT
                    type: input, required; description: input of general information</li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">-e</code>, <code class="language-plaintext highlighter-rouge">--espot</code> ESPOT
                    type: input, required; description: input of ESP and coordinates</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">-q</code>, <code class="language-plaintext highlighter-rouge">--qin</code> QIN   type: input, optional; description: replacement parameters</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">-o</code>, <code class="language-plaintext highlighter-rouge">--output</code> OUTPUT
                    type: output, always produced; description: output of results</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">-t</code>, <code class="language-plaintext highlighter-rouge">--qout</code> QOUT type: output, always produced; description: output of parameters</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">-s</code>, <code class="language-plaintext highlighter-rouge">--esout</code> ESOUT
                    type: output, optional; description: generated ESP values for new parameters</p>
  </li>
  <li><code class="language-plaintext highlighter-rouge">-ip</code> POLARIZ, –polariz POLARIZ
                    type: input, optional; description: atomic polarizabilities</li>
</ol>

<hr />

<h1 id="4-examples">4. Examples</h1>

<h4 id="41-case-1-ch3sch3">4.1 Case 1: CH3SCH3</h4>

<div align="center">
<img src="/assets/2023_pyrespgen/CH3SCH3_example.png" width="100" height="" alt="rmsd" />
 </div>

<h1 id="references">References</h1>

<div id="refer-anchor-1"></div>
<p>[1] Qiang Zhu, Yang Ge, Wei Li,* and Jing Ma*. <a href="https://pubs.acs.org/doi/abs/10.1021/acs.jctc.2c01130?casa_token=eu4gzasL3FgAAAAA:9WLmHUtsPjEvRSd4qAFw76UMxVgQdXr2MDYXNv0nnQsa929qSeTpTXxNlTssMeDPgFbtCvYrKbhtLnr1">Treating Polarization Effects in Charged and Polar Bio-Molecules Through Variable Electrostatic Parameters.</a> <em>J. Chem. Theory Comput.</em> <strong>2023</strong>, 19, 2, 396–411;</p>

<div id="refer-anchor-2"></div>
<p>[2] Shiji Zhao, Haixin Wei, Piotr Cieplak, Yong Duan,* and Ray Luo.* <a href="https://pubs.acs.org/doi/abs/10.1021/acs.jctc.2c00230?casa_token=ztCXn3gxZjgAAAAA:OXdVwLy-DwjKzCY2-62X302bHkTPHO5LqnZnSZfjSY5k2X_aCJScTlgynnnfSYbf-_ynAK9rHud0aFXj">PyRESP: A Program for Electrostatic Parameterizations of Additive and Induced Dipole Polarizable Force Fields.</a> <em>J. Chem. Theory Comput.</em> <strong>2022</strong>, 18, 6, 3654–3670</p>

<div id="refer-anchor-3"></div>
<p>[3] Junmei Wang*, Piotr Cieplak, Ray Luo, and Yong Duan*. <a href="https://pubs.acs.org/doi/abs/10.1021/acs.jctc.8b00603?casa_token=hzcpqUV1swgAAAAA:q_uwP4QZEup2RsmEgMMhHdRf0igZ8bSEm7-mcfaEAWlLjKDyIZ8UM0jZDpKoNXahsN0iklXs5OCt_aAS">Development of Polarizable Gaussian Model for Molecular Mechanical Calculations I: Atomic Polarizability Parameterization To Reproduce ab Initio Anisotropy.</a> <em>J. Chem. Theory Comput.</em> <strong>2019</strong>, 15, 2, 1146–1158</p>

<div id="refer-anchor-4"></div>
<p>[4] Qiang Zhu, Yong Duan,* Ray Luo.* <strong>2023</strong> (To be submitted)</p>

:ET